---
import RecommendedWork from "../../components/RecommendedWorkFrontpage.tsx";
import { recommendedWork } from "../../store";

const rw = recommendedWork.get();

const workList = ["sa", "sppoc", "iomusic", "webapps", "ecomm", "sfm"].map(
  (key: string) => ({
    bgcolor: rw[key].bgcolor,
    image: rw[key].image,
    title: rw[key].title,
    description: rw[key].description,
    link: rw[key].link,
  })
);
---

<div class="work">
  <div class="work__header">
    <h2>Featured Work</h2>
    <p>A selection of website and app work</p>
  </div>
  <div class="work__body">
    {
      workList.map(
        (work: {
          image: { src: string };
          title: string;
          description: string;
          bgcolor: string;
          link: string;
        }) => (
          <RecommendedWork
            image={work.image?.src}
            title={work.title}
            description={work.description}
            link={work.link}
            bgcolor={work.bgcolor}
            client:load
          />
        )
      )
    }
  </div>
</div>

<script>
  import { inView } from "motion";

  inView(".work__item", (element) => {
    element.setAttribute("inview", "");

    return () => {
      element.removeAttribute("inview");
    };
  });
</script>

<style>
  .work__body {
    --grid-template-columns: 1fr;
  }

  @media screen and (min-width: 540px) {
    .work__body {
      --grid-template-columns: repeat(2, 1fr);
    }
  }

  @media screen and (min-width: 768px) {
    .work__body {
      --grid-template-columns: repeat(3, 1fr);
    }
  }

  .work__header {
    text-align: center;
  }

  .work__header h2 {
    font-size: clamp(
      var(--font-size-lg),
      calc(7vw + 1rem),
      var(--font-size-xl)
    );
    color: var(--color-secondary);
  }

  .work__body {
    margin-top: var(--space-8);
    display: grid;
    grid-template-columns: var(--grid-template-columns);
    gap: var(--space-8);
    place-items: center;
  }

  .work__item {
    border: none;
    padding: 0;
    cursor: pointer;
    width: clamp(240px, 100%, 600px);
    aspect-ratio: 1;
    background-size: 100%;
    background-position: 0% 0%;
    border-radius: var(--border-radius-lg);
    scale: 0.8;
    transition: all 800ms var(--ease-out-elastic);
    overflow: hidden;
    position: relative;
  }

  .work__item > span {
    display: none;
  }

  .work__item[inview] {
    scale: 1;
  }

  .work__item:hover,
  .work__item:focus {
    scale: 1.02;
    mix-blend-mode: initial;
  }

  .work__item:active {
    scale: 0.95;
  }

  .work__item img {
    height: auto;
    object-fit: cover;
    scale: 1.3;
  }
</style>
